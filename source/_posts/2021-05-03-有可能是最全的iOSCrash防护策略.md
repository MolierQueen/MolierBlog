---
title: 有可能是最全的iOSCrash防护策略
tags:
  - iOS
  - Crash防护
categories: iOS开发
comments:
---

# 0x1 为什么要做Crash防护

 在产品开发过程中Crash率是一个很重要的指标，也是一个团队中几乎所有的部门都应该关注或者去参与提升的一个指标，他不仅代表着整个产品的质量，也是一个团队整体技术能力的体现。更低的Crash率不但能让产品获得更好的用户口碑，在整个流程中也能让团队成员获得更多的成长，加深对iOS系统底层的理解，为今后的开发带了更大的帮助。

![](https://image-1256056152.cos.ap-nanjing.myqcloud.com/1111111111.jpeg)

<!-- more -->

# 0x2 为什么要写这篇文章

起因也是因为自己的项目踩了FB的SDK的坑：2020.7.10，FB后台下发数据错误，导致大量使用FB SDK的App发生启动Crash，影响用户之多，范围之大，再加上当时包括我们的大部分App也缺乏相关的防护或者是容错处理，Crash率瞬间飙升，重新发版又要走发布流程，只能依赖FB后台的修复，当时束手无策十分被动，所以决定自己做一套较为完整的Crash防护体系，来避免这样的场景再次发生。写这篇文章第二个目的也是将自己最近相关的研究和调研记录下来，知识是要沉淀、积累和分享的，也算是加深自己的理解吧。

# 0x3 怎么做

其实当时Crash的场景很简单，本来一个Dictionary参数FB后台却下发了个String类型的数据，这样一来解析时候必然会Crash，解决的话其实只要做一层参数安全校验即可，

![](https://tva1.sinaimg.cn/large/008i3skNly1gq58dki0g7j31ai0u01fd.jpg)

![](https://tva1.sinaimg.cn/large/008i3skNly1gq58c923pfj31020t8k5g.jpg)

但是这么简单的问题，大部分App都没处理，证明在流程上一定有大家注意不到的地方，暴露出来的只是冰山一角，我们机制一定存在着某种问题，或者存在这个可以优化的地方。


{% aplayerlist %}
{
    "autoplay": true,
    "showlrc": 0,
    "mutex": true,
    "music": [
        {
            "title": "奔赴星空",
            "author": "尹昔眠",
            "url": " https://molier-1256056152.cos.ap-guangzhou.myqcloud.com/%E5%B0%B9%E6%98%94%E7%9C%A0%20-%20%E5%A5%94%E8%B5%B4%E6%98%9F%E7%A9%BA.mp3",
            "pic": "https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimge.kugou.com%2Fstdmusic%2F240%2F20210402%2F20210402114314135880.jpg&refer=http%3A%2F%2Fimge.kugou.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1622613157&t=cd770b23f2e60662dde0e28d397877c8",
            "lrc": "https://歌词.lrc"
        }
    ]
}
{% endaplayerlist %}